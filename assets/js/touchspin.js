!function(t){"use strict";function o(o,n){return t.map(o,(function(t){return function(t,o){return t+".touchspin_"+o}(t,n)}))}var n=0;t.fn.TouchSpin=function(s){if("destroy"!==s){var e={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},a={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each((function(){function i(o){v=t.extend({},v,o)}function u(o){o.addClass("bootstrap-touchspin");var n,s,e=D.prev(),a=D.next(),i='<span class="input-group-addon bootstrap-touchspin-prefix">'+v.prefix+"</span>",u='<span class="input-group-addon bootstrap-touchspin-postfix">'+v.postfix+"</span>";e.hasClass("input-group-btn")?(n='<button class="'+v.buttondown_class+' bootstrap-touchspin-down" type="button">'+v.buttondown_txt+"</button>",e.append(n)):(n='<span class="input-group-btn"><button class="'+v.buttondown_class+' bootstrap-touchspin-down" type="button">'+v.buttondown_txt+"</button></span>",t(n).insertBefore(D)),a.hasClass("input-group-btn")?(s='<button class="'+v.buttonup_class+' bootstrap-touchspin-up" type="button">'+v.buttonup_txt+"</button>",a.prepend(s)):(s='<span class="input-group-btn"><button class="'+v.buttonup_class+' bootstrap-touchspin-up" type="button">'+v.buttonup_txt+"</button></span>",t(s).insertAfter(D)),t(i).insertBefore(D),t(u).insertAfter(D),m=o}function p(){var o;o=v.verticalbuttons?'<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+v.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+v.postfix+'</span><span class="input-group-btn-vertical"><button class="'+v.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+v.verticalupclass+'"></i></button><button class="'+v.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+v.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+v.buttondown_class+' bootstrap-touchspin-down" type="button">'+v.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+v.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+v.postfix+'</span><span class="input-group-btn"><button class="'+v.buttonup_class+' bootstrap-touchspin-up" type="button">'+v.buttonup_txt+"</button></span></div>",m=t(o).insertBefore(D),t(".bootstrap-touchspin-prefix",m).after(D),D.hasClass("input-sm")?m.addClass("input-group-sm"):D.hasClass("input-lg")&&m.addClass("input-group-lg")}function r(){var t,o,n;return""===(t=D.val())?void(""!==v.replacementval&&(D.val(v.replacementval),D.trigger("change"))):void(v.decimals>0&&"."===t||(o=parseFloat(t),isNaN(o)&&(o=""!==v.replacementval?v.replacementval:0),n=o,o.toString()!==t&&(n=o),o<v.min&&(n=v.min),o>v.max&&(n=v.max),n=function(t){switch(v.forcestepdivisibility){case"round":return(Math.round(t/v.step)*v.step).toFixed(v.decimals);case"floor":return(Math.floor(t/v.step)*v.step).toFixed(v.decimals);case"ceil":return(Math.ceil(t/v.step)*v.step).toFixed(v.decimals);default:return t}}(n),Number(t).toString()!==n.toString()&&(D.val(n),D.trigger("change"))))}function c(){if(v.booster){var t=Math.pow(2,Math.floor(F/v.boostat))*v.step;return v.maxboostedstep&&t>v.maxboostedstep&&(t=v.maxboostedstep,g=Math.round(g/t)*t),Math.max(v.step,t)}return v.step}function l(){r(),g=parseFloat(x.input.val()),isNaN(g)&&(g=0);var t=g,o=c();(g+=o)>v.max&&(g=v.max,D.trigger("touchspin.on.max"),h()),x.input.val(Number(g).toFixed(v.decimals)),t!==g&&D.trigger("change")}function d(){r(),g=parseFloat(x.input.val()),isNaN(g)&&(g=0);var t=g,o=c();(g-=o)<v.min&&(g=v.min,D.trigger("touchspin.on.min"),h()),x.input.val(g.toFixed(v.decimals)),t!==g&&D.trigger("change")}function f(){h(),F=0,M="down",D.trigger("touchspin.on.startspin"),D.trigger("touchspin.on.startdownspin"),_=setTimeout((function(){w=setInterval((function(){F++,d()}),v.stepinterval)}),v.stepintervaldelay)}function b(){h(),F=0,M="up",D.trigger("touchspin.on.startspin"),D.trigger("touchspin.on.startupspin"),C=setTimeout((function(){y=setInterval((function(){F++,l()}),v.stepinterval)}),v.stepintervaldelay)}function h(){switch(clearTimeout(_),clearTimeout(C),clearInterval(w),clearInterval(y),M){case"up":D.trigger("touchspin.on.stopupspin"),D.trigger("touchspin.on.stopspin");break;case"down":D.trigger("touchspin.on.stopdownspin"),D.trigger("touchspin.on.stopspin")}F=0,M=!1}var v,m,x,g,w,y,_,C,D=t(this),k=D.data(),F=0,M=!1;!function(){if(!D.data("alreadyinitialized")){if(D.data("alreadyinitialized",!0),n+=1,D.data("spinnerid",n),!D.is("input"))return void console.log("Must be an input.");v=t.extend({},e,k,function(){var o={};return t.each(a,(function(t,n){var s="bts-"+n;D.is("[data-"+s+"]")&&(o[t]=D.data(s))})),o}(),s),""!==v.initval&&""===D.val()&&D.val(v.initval),r(),function(){var t=D.val(),o=D.parent();""!==t&&(t=Number(t).toFixed(v.decimals)),D.data("initvalue",t).val(t),D.addClass("form-control"),o.hasClass("input-group")?u(o):p()}(),x={down:t(".bootstrap-touchspin-down",m),up:t(".bootstrap-touchspin-up",m),input:t("input",m),prefix:t(".bootstrap-touchspin-prefix",m).addClass(v.prefix_extraclass),postfix:t(".bootstrap-touchspin-postfix",m).addClass(v.postfix_extraclass)},""===v.prefix&&x.prefix.hide(),""===v.postfix&&x.postfix.hide(),D.on("keydown",(function(t){var o=t.keyCode||t.which;38===o?("up"!==M&&(l(),b()),t.preventDefault()):40===o&&("down"!==M&&(d(),f()),t.preventDefault())})),D.on("keyup",(function(t){var o=t.keyCode||t.which;(38===o||40===o)&&h()})),D.on("blur",(function(){r()})),x.down.on("keydown",(function(t){var o=t.keyCode||t.which;32!==o&&13!==o||("down"!==M&&(d(),f()),t.preventDefault())})),x.down.on("keyup",(function(t){var o=t.keyCode||t.which;32!==o&&13!==o||h()})),x.up.on("keydown",(function(t){var o=t.keyCode||t.which;32!==o&&13!==o||("up"!==M&&(l(),b()),t.preventDefault())})),x.up.on("keyup",(function(t){var o=t.keyCode||t.which;32!==o&&13!==o||h()})),x.down.on("mousedown.touchspin",(function(t){x.down.off("touchstart.touchspin"),D.is(":disabled")||(d(),f(),t.preventDefault(),t.stopPropagation())})),x.down.on("touchstart.touchspin",(function(t){x.down.off("mousedown.touchspin"),D.is(":disabled")||(d(),f(),t.preventDefault(),t.stopPropagation())})),x.up.on("mousedown.touchspin",(function(t){x.up.off("touchstart.touchspin"),D.is(":disabled")||(l(),b(),t.preventDefault(),t.stopPropagation())})),x.up.on("touchstart.touchspin",(function(t){x.up.off("mousedown.touchspin"),D.is(":disabled")||(l(),b(),t.preventDefault(),t.stopPropagation())})),x.up.on("mouseout touchleave touchend touchcancel",(function(t){M&&(t.stopPropagation(),h())})),x.down.on("mouseout touchleave touchend touchcancel",(function(t){M&&(t.stopPropagation(),h())})),x.down.on("mousemove touchmove",(function(t){M&&(t.stopPropagation(),t.preventDefault())})),x.up.on("mousemove touchmove",(function(t){M&&(t.stopPropagation(),t.preventDefault())})),t(document).on(o(["mouseup","touchend","touchcancel"],n).join(" "),(function(t){M&&(t.preventDefault(),h())})),t(document).on(o(["mousemove","touchmove","scroll","scrollstart"],n).join(" "),(function(t){M&&(t.preventDefault(),h())})),D.on("mousewheel DOMMouseScroll",(function(t){if(v.mousewheel&&D.is(":focus")){var o=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),o<0?d():l()}})),D.on("touchspin.uponce",(function(){h(),l()})),D.on("touchspin.downonce",(function(){h(),d()})),D.on("touchspin.startupspin",(function(){b()})),D.on("touchspin.startdownspin",(function(){f()})),D.on("touchspin.stopspin",(function(){h()})),D.on("touchspin.updatesettings",(function(t,o){!function(t){i(t),r();var o=x.input.val();""!==o&&(o=Number(x.input.val()),x.input.val(o.toFixed(v.decimals)))}(o)})),x.input.css("display","block")}}()}))}this.each((function(){var n=t(this).data();t(document).off(o(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],n.spinnerid).join(" "))}))}}(jQuery);